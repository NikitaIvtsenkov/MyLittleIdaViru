# MY LITTLE IDA-VIRU
Этот веб-сайт представляет собой интерактивный виртуальный гид и афишу мероприятий в регионе Ида-Вирумаа, Эстония. Пользователи могут просматривать актуальные события и интересные места по всему региону. 

Разработчики: [Никита Ивченков](https://github.com/NikitaIvtsenkov) и [Глеб Рыжов](https://github.com/glebRov1).

Ссылки: [Figma](https://www.figma.com/design/zUCvN5fYRsNiQXpBgMu9sl/L%C3%B5put%C3%B6%C3%B6-pt2?node-id=0-1&t=LsUWbrPw6F4otoj9-1) и [Веб-сайт](https://mliv.zapto.org/).

---

## ЦЕЛЬ РАБОТЫ И ОСНОВНЫЕ ФУНКЦИИ
Цель данной работы — разработка интерактивной платформы, предназначенной для предоставления информации о различных событиях и мероприятиях и интересных локациях на карте. 

Платформа оснащена функциями:

- Масштабированием карты с динамическим обновлением отображаемых объектов.
- Отображение меток достопримечательностей в зависимости от масштаба и фильтров.
- Клик на метку выводит всплывающее окно с краткой информацией и ссылкой на полное описание объекта.
- Поиск и фильтрация мест на карте
- Переключение языка интерфейса

Выбранные технологии: 

[![Node][Node.js]][Node-url] [![React][React.js]][React-url] [![Sequelize][Sequelize]][Sequelize-url] [![Express][Express]][Express-url] [![MySQL][MySQL]][MySQL-url]

[Node.js]: https://img.shields.io/badge/node.js-000000?style=for-the-badge&logo=nodedotjs&logoColor=white
[Node-url]: https://nodejs.org/en
[React.js]: https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB
[React-url]: https://reactjs.org/
[Sequelize]: https://img.shields.io/badge/Sequelize-52B0E7?style=for-the-badge&logo=sequelize&logoColor=white
[Sequelize-url]: https://sequelize.org/
[Express]: https://img.shields.io/badge/Express-000000?style=for-the-badge&logo=express&logoColor=white
[Express-url]: https://expressjs.com/
[MySQL]: https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white
[MySQL-url]: https://www.mysql.com/

---

## ПОДРОБНАЯ ИНСТРУКЦИЯ ПО НАСТРОЙКЕ И ЗАПУСКУ ПРОЕКТА

Эта инструкция поможет вам настроить веб-проект локально. Она включает установку необходимых инструментов, клонирование проекта, настройку окружения, создание базы данных и запуск приложения.

Следуйте слудующим шагам для коректной установки и запуску проекта:

<br/>

### Шаг 1. Установка Visual Studio Code (VS Code)
`Visual Studio Code` — это легкий и мощный редактор кода, поддерживающий `JavaScript`, `Node.js` и другие технологии. Следуйте этим шагам для его установки:
- Перейдите на официальный сайт Visual Studio Code: [Code.visualstudio.com](https://code.visualstudio.com/).
- Нажмите кнопку `Скачать` для вашей операционной системы (`Windows`, `macOS` или `Linux`).
- Запустите загруженный установочный файл.
- Следуйте инструкциям установки.
- После установки запустите `VS Code`.
> [!TIP]
> Установите расширения для VS Code, такие как: [JavaScript (ES6) code snippets](https://marketplace.visualstudio.com/items?itemName=xabikos.JavaScriptSnippets), [ES7 React/Redux/GraphQL/React-Native snippets](https://marketplace.visualstudio.com/items?itemName=rodrigovallades.es7-react-js-snippets), [IntelliCode](https://marketplace.visualstudio.com/items?itemName=VisualStudioExptTeam.vscodeintellicode) и [Jupyter](https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter) для упрощения разработки.

### Шаг 1.1. Установка Node.js
Скачайте и установите Node.js версии 22 или выше с сайта [nodejs.org](https://nodejs.org/).

Для проверки установки откройте cmd и выполните:
```
node -v  # Должно отобразить v22.x или выше
```

<br/>

### Шаг 2: Клонирование проекта с GitHub
Чтобы начать работу с проектом, необходимо клонировать его репозиторий с `GitHub` на ваш компьютер. Вы можете сделать это через веб-интерфейс GitHub.
- Откройте браузер и перейдите на страницу репозитория на GitHub: [https://github.com/NikitaIvtsenkov/MyLittleIdaViru](https://github.com/NikitaIvtsenkov/MyLittleIdaViru).
- На главной странице репозитория найдите зеленую кнопку `Code`. Нажмите на нее, чтобы открыть выпадающее меню.
- В меню выберите `Download ZIP`.
- Выберите пустую папку или создайте новую. Перенесите скачанный проект в эту папку. Щелкните правой кнопкой мыши по файлу и выберите `Извлечь все` (или используйте программу, например, `7-Zip` или `WinRAR`).
> [!WARNING]
> Убедитесь, что внутри есть папки backend и frontend

<br/>

### Шаг 3: Установка и настройка XAMPP
XAMPP — это программный пакет, который предоставляет Apache и MySQL для локальной веб-разработки. На этом этапе вы установите XAMPP, запустите необходимые службы, создадите базу данных и импортируете данные.
- Перейдите на официальный сайт XAMPP: [Apachefriends.org](https://www.apachefriends.org/).
- Скачайте версию для вашей операционной системы (`Windows`, `macOS` или `Linux`).
- Запустите установочный файл.
- Выберите компоненты для установки (убедитесь, что выбраны `Apache` и `MySQL`).
- Выберите папку для установки (по умолчанию `C:\xampp` в Windows) и звершите процесс установки.
- Откройте панель управления XAMPP (найдите `XAMPP Control Panel` в меню «Пуск»).
### Шаг 3.1: Запуск Apache:
- В панели управления XAMPP найдите модуль `Apache`.
- Нажмите кнопку `Start` рядом с Apache.
- Дождитесь, пока индикатор статуса станет зеленым, что означает, что Apache запущен.
### Шаг 3.2: Запуск MySQL:
- В панели управления XAMPP найдите модуль `MySQL`.
- Нажмите кнопку `Start` рядом с MySQL.
- Дождитесь, пока индикатор статуса станет зеленым, что означает, что MySQL запущен.

<br/>

### Шаг 4: Создание и настройка базы данных в phpMyAdmin
Вам нужно создать базу данных с именем `vturevents` и импортировать в нее необходимые данные.
- Для открытия страницы `phpMyAdmin`, вы можете нажмить на кнопку Admin в разделе MySQL или откройте браузер и перейдите по адресу: [http://localhost/phpmyadmin/](http://localhost/phpmyadmin/)
- В phpMyAdmin нажмите на вкладку «Базы данных» в верхней части интерфейса.
- В разделе `Создать базу данных` введите имя `vturevents`.
- В выпадающeй меню выберите кодировку `utf8_general_ci` (обеспечивает правильную обработку символов).
- Нажмите кнопку `Создать`.
### Шаг 4.1: Импорт таблиц и данных в базу данных
- В phpMyAdmin щелкните по базе данных `vturevents` в левой боковой панели, чтобы выбрать ее.
- Нажмите на вкладку `Импорт` в верхней части интерфейса phpMyAdmin.
- В разделе `Файл для импорта` нажмите кнопку `Выбрать файл`.
- Найдите файл `vturevents.sql`, выберите файл и нажмите `Открыть`.
- Нажмите кнопку `Вперед` в нижней части страницы.
> [!IMPORTANT]
> PhpMyAdmin обработает SQL-файл, создаст таблицы и вставит данные. После завершения вы должны увидеть сообщение об успехе (например, «Импорт успешно завершен»).

<br/>

### Шаг 5: Открытие проекта в Visual Studio Code
- Откройте `Visual Studio Code`, если он еще не открыт.
- В VS Code выберите `Файл > Открыть папку`.
- Перейдите в директорию, куда вы клонировали или распаковали проект (например, `C:\Users\Nikita\Documents\Projects\Mlliv)`, выберите папку проекта и нажмите `Выбрать папку`.
- В проводнике VS Code (левая боковая панель) вы должны увидеть структуру папок проекта, включая:
```
VTUR/
├── backend/
│   ├── config/
│   ├── controllers/
│   ├── models/
│   ├── public/
│   ├── routes/
│   ├── validations/
│   ├── index.js
│   ├── package-lock.json
│   ├── package.json
│   └── swagger.js
├── frontend/
│   ├── public/
│   ├── src/
│   ├── .gitignore
│   ├── package-lock.json
│   ├── package.json
├── README.md
```
> [!WARNING]
> Разверните папки `backend` и `frontend`, чтобы убедиться, что ключевые файлы (например, `index.js` в `backend`, `package.json` в обеих папках) присутствуют.

### Шаг 5.1: Создание файла .env для backend
- В папке backend создайте новый файл с именем .env.
- Отредактируйте файл .env в текстовом редакторе (например, Блокнот или VS Code) и заполните следующие переменые:
```
DB_NAME=vturEvents            #Название базы данных (например, vturEvents).
DB_USER=root                  #Имя пользователя базы данных (по умолчанию root для MySQL в XAMPP).
DB_PASSWORD=                  #Пароль пользователя базы данных (оставьте пустым, если не задавали пароль при установке XAMPP).
DB_HOST=localhost             #Хост базы данных (обычно localhost для локальной разработки).
DB_DIALECT=mysql              #Диалект базы данных (укажите mysql для MySQL).
SECRET_KEY=testsecret         #Секретный ключ для безопасности приложения (например, testsecret для тестирования).
```
> [!CAUTION]
> Убедитесь, что файл сохранен в папке `backend` и не имеет расширения (например, не `.env.txt`).
  
<br/>

### Шаг 6: Настройка и запуск Backend
- В VS Code выберите `Терминал > Новый терминал` или нажмите `Ctrl + ~` (обратная кавычка). Панель терминала откроется в нижней части окна VS Code.
- В терминале выполните команды:
```
cd backend
npm install --legacy-peer-deps
```
- Дождитесь завершения установки (это может занять несколько минут).
- В папке `backen`d должны появиться папка `node_modules` и файл `package-lock.json`.
```
VTUR/
├── backend/
│   ├── ...
│   ├── node_modules/
│   ├── package-lock.json
├── frontend/
│   ├── ...
├── README.md
```
- Выполните следующую команду для парсинга ивентов и запуска сервера backend:
```
node parse.js
npm run dev
```
- Вы должны увидеть вывод, указывающий, что сервер запущен, например:
```
Database Connected ....
Server running at port 5000
```
> [!CAUTION]
> Если возникают ошибки, проверьте:
>  - Правильность значений в файле `.env`.
>  - Работают ли `Apache` и `MySQL` в `XAMPP`.
>  - Существует ли база данных `vturevent`s с импортированными таблицами.

<br/>

### Шаг 7: Настройка и запуск Frontend
- В VS Code нажмите кнопку `+` в панели терминала, чтобы открыть новую вкладку терминала, или выберите `Терминал > Новый терминал`. Это позволит оставить первый терминал с backend активным.
- В новом терминале выполните:
```
cd frontend
npm install --legacy-peer-deps
```
- Дождитесь завершения установки. В папке `frontend` должны появиться папка `node_modules` и файл `package-lock.json`.
```
VTUR/
├── backend/
│   ├── ...
├── frontend/
│   ├── ...
│   ├── node_modules/
│   ├── package-lock.json
├── README.md
```
- Выполните следующую команду для запуска сервера разработки frontend:
```
npm start
```
- В терминале должны появиться сообщения, указывающие, что приложение запущено, и ваш браузер может автоматически открыть страницу `http://localhost:3000`.
```
frontend@0.1.0 start
react-scripts start
Starting the development server...
```

<br/>

## РАБОТА С ПРОЕКТОМ
Поздравляем! На данном этапе вы должны увидеть работающее приложение, от лица `не зарегистрированного пользователя`. Если все шаги выполнены корректно, откройте браузер по адресу `http://localhost:3000`.

<br/>

![Скриншот главной страницы](https://github.com/user-attachments/assets/b0b8c809-17af-41cd-9459-d62c69ec7655)

<br/>

После успешной настройки и запуска проекта вы можете начать его использование. Вот инструкции по основным сценариям работы:

### Просмотр сайта через неавторизованных пользователей
- На главной странице доступна `карта`, которая позволяет просматривать `места и события`.
- Пользователи могут просматривать `список мест` (например, Apollo Cinema, Concert Hall и т.д.) и их детали, такие как `город`, `местоположение`, `часы работы` и `категории`.
- Карта отображает места с событиями и без событий, предоставляя визуальное представление данных.
- Нет необходимости в регистрации или авторизации для просмотра общедоступной информации.

### Работа с сайтом через панель администратора
- Чтобы войти в `админ-панель`, вручную введите в адресной строке браузера: `http://localhost:3000/login`.
- Для входа в админ панель введите следующие учетные данные:
```
admin@mail.com          #Email от аккаунта админа.
admin123                #Пароль от аккаунта админа.
```
- После успешного входа вы будете перенаправлены на главную страницу, где в верхнем и нижнем навигационным меню появятся пункты: `админ-панель` и `выход` из аккаунта администратора, как показано на скриншоте.

<br/>

![Скриншот верхней навигационной панели для администратора](https://github.com/user-attachments/assets/a401baf5-fe20-47b8-ad8e-aeff0f406c15)
![Скриншот нижней навигационной панели для администратора](https://github.com/user-attachments/assets/0e6bb542-47c6-4487-bad0-9c77111c9325)

<br/>

### Функционал админ-панели
- На дашборде отображается статистика: `общее количество мест`,` мест с событиями и мест без событий`.
- При необходимости добавления новых городов или мест, нажмите `Add New City`, `Add New Category`, `Add New Place` или `Add New Event`, чтобы добавить новый город, категорию, место или событие соответственно.
- В разделе `List View` отображаются места с колонками: `Фото`, `Название`, `Город`, `Местоположение`, `Часы работы`, `Категории`, `Наличие событий`,` Действия`.
- Можно фильтровать данные по городам (например, Jõhvi, Kohtla-Järve, Narva), событиям и категориям с помощью фильтров.
- Используйте иконки действий (`карандаш для редактирования`, `корзина для удаления`) для управления записями.
- Админ может просматривать и редактировать детали мест, добавлять новые события и управлять категориями городов.

<br/>

![image](https://github.com/user-attachments/assets/0fbbaf40-40d7-493c-a73b-75e8ab7d0fd1)


<br/>

## ER диаграмма

<br/>

![image](https://github.com/user-attachments/assets/d83964e9-69f5-4c4f-88db-97474e6b2638)


<br/>

### 1. `vtur_categories`
| Поле  | Тип       | Описание             |
|-------|-----------|----------------------|
| id    | int(11)   | Первичный ключ       |
| name  | varchar(255) | Название категории |
| icon  | varchar(255) | Иконка категории    |

### 2. `vtur_many_to_many_categories`
| Поле        | Тип       | Описание                     |
|-------------|-----------|------------------------------|
| place_id    | int(11)   | Внешний ключ, ссылающийся на `vtur_places` |
| category_id | int(11)   | Внешний ключ, ссылающийся на `vtur_categories` |

### 3. `vtur_users`
| Поле     | Тип       | Описание             |
|----------|-----------|----------------------|
| id       | int(11)   | Первичный ключ       |
| name     | varchar(255) | Имя пользователя  |
| email    | varchar(255) | Email пользователя  |
| password | varchar(255) | Пароль пользователя (захэшированный) |

### 4. `vtur_places`
| Поле          | Тип       | Описание                     |
|---------------|-----------|------------------------------|
| id            | int(11)   | Первичный ключ               |
| name          | varchar(255) | Название места           |
| photo         | varchar(255) | URL или путь к фото      |
| working_hours | varchar(255) | Часы работы              |
| location      | text      | Описание местоположения      |
| web           | varchar(255) | URL веб-сайта            |
| description   | text      | Подробное описание           |
| latitude      | double    | Координата широты            |
| longitude     | double    | Координата долготы           |
| city          | int(11)   | Внешний ключ, ссылающийся на `vtur_cities` |

### 5. `vtur_events`
| Поле         | Тип       | Описание                     |
|--------------|-----------|------------------------------|
| id           | int(11)   | Первичный ключ               |
| url          | varchar(255) | URL события             |
| name         | varchar(255) | Название события         |
| description  | text      | Описание события             |
| image        | varchar(255) | URL или путь к изображению |
| placeId      | int(11)   | Внешний ключ, ссылающийся на `vtur_places` |
| hash         | varchar(32) | Уникальный хэш            |
| created_at   | datetime  | Метка времени создания       |
| updated_at   | datetime  | Метка времени последнего обновления |

### 6. `vtur_cities`
| Поле       | Тип       | Описание             |
|------------|-----------|----------------------|
| id         | int(11)   | Первичный ключ       |
| city_name  | varchar(255) | Название города   |
| latitude   | double    | Координата широты    |
| longitude  | double    | Координата долготы   |

### Связи в таблицах
- **`vtur_many_to_many_categories`**: Связывает таблицы (многие ко многим).
- **`vtur_places` → `vtur_cities`**: Одна запись может иметь множество других (один ко многим через поле `city`).
- **`vtur_events` → `vtur_places`**: Одна запись может иметь множество других (один ко многим через поле `placeId`).

## УНИКАЛЬНЫЕ ФИШКИ ПРОЕКТА
Проект обладает рядом уникальных функций, которые делают его удобным и эффективным для управления событиями и местами.

### Автоматический парсинг событий
Сайт автоматически собирает информацию о событиях с веб-сайтов мест, где проходят мероприятия. Это позволяет поддерживать актуальный список событий без ручного вмешательства. 
Обновление событий происходит каждый час, что гарантирует отображение только актуальных мероприятий на текущий момент.
При необходимости события можно добавлять или редактировать вручную через админ-панель.

### Автоматическое создание страниц городов
При добавлении нового города в админ-панели страница для этого города создается автоматически. Вам не нужно вручную писать код или создавать шаблоны — система сделает это за вас.

### Удобное добавление новых мест
Добавление новых мест происходит быстро и интуитивно через админ-панель. Вы можете легко указать описание места, добавить изображение (в виде ссылки или загрузить файл непосредственно на сервер) и настроить другие параметры, такие как категории и часы работы.

### Слабые стороны
Несмотря на автоматизацию парсинга событий, добавление нового источника парсинга для места не автоматизировано. Для каждого нового места, с которого нужно собирать события, требуется написать отдельный код парсинга. Это может быть трудоемким процессом, особенно если структура сайта места сложная или часто меняется.

# Заключение
Вы успешно настроили и запустили проект на своем устройстве! Вы готовы исследовать все возможности сайта, включая просмотр событий и управление контентом через админ-панель. Этот проект сочетает в себе удобство автоматического парсинга, автоматизированного создания страниц и гибкость ручного управления, что делает его мощным инструментом для работы с местами и событиями.
